<div class="col-md-12">
    <div class="card">
        <div class="header">
            <h4 class="title">APK Analysis</h4>
            <p class="category">Detailed Results</p>
        </div>
        {% if 'dex' in results %}
        <div class="content">
            <p>Analyzed file is a DEX file, not an APK.</p>
        </div>
        {% else %}
        <div class="content">
            <label>Name</label>
            <div class="labeled-content">{{results.name}}</div>
            <label>Package</label>
            <div class="labeled-content">{{results.package}}</div>

            <label>Permissions</label>
            <div class="labeled-content">
            
            <table>
                <tr>
                    <th>Permission</th>
                    <th>Protection Level</th>
                    <th>Label</th>
                    <th>Description</th>
                </tr>
                {% for permission_name, permission in results.permissions.iteritems() %}
                    <tr>
                        <td><div>{{permission_name}}</div></td>
                        <td><div>{{permission[0]}}</div></td>
                        <td><div>{{permission[1]}}</div></td>
                        <td><div>{{permission[2]}}</div></td>
                    </tr>
                {% endfor %}
            </table>
            </div>

            <label>Declared Permissions</label>
            <div class="labeled-content">
            
            <table>
                <tr>
                    <th>Permission</th>
                    <th>Protection Level</th>
                    <th>Label</th>
                    <th>Description</th>
                </tr>
                {% for permission_name, permission in results.declared_permissions.iteritems() %}
                    <tr>
                        <td><div>{{permission_name}}</div></td>
                        <td><div>{{permission[0]}}</div></td>
                        <td><div>{{permission[1]}}</div></td>
                        <td><div>{{permission[2]}}</div></td>
                    </tr>
                {% endfor %}
            </table>
            </div>

            <label>Activities</label>
            <div class="labeled-content">
            {% for activity in results.activities %}
                <div>{{activity}}</div>
            {% endfor %}
            </div>
            <label>Providers</label>
            <div class="labeled-content">
            {% for provider in results.providers %}
                <div>{{provider}}</div>
            {% endfor %}
            </div>
            <label>Receivers</label>
            <div class="labeled-content">
            {% for receiver in results.receivers %}
                <div>{{receiver}}</div>
            {% endfor %}
            </div>
            <label>Services</label>
            <div class="labeled-content">
            {% for service in results.services %}
                <div>{{service}}</div>
            {% endfor %}
            </div>
            <label>Main Activity</label>
            <div class="labeled-content">{{results.main_activity}}</div>
            <pre><code class="java">{{results.main_activity_content}}</code>
            </pre>

            <label>Manifest</label>
            <div class="labeled-content">
                <pre><code class="xml">{{results.manifest}}</code></pre>
            </div>

            <label>Files</label>
            <div class="labeled-content">
            <table>
             <tr>
                <th>Name</th>
                <th>Type</th>
            </tr>
            {% for name, magic in results.files.iteritems() %}
                <tr>
                    <td>{{name}}</td>
                    <td>{{magic}}</td>
                </tr>
            {% endfor %}
            </table>
            </div>
            <label>Internal Classes</label>
            <div class="labeled-content">
            {% for internal_class in results.internal_classes %}
                <div>{{internal_class.name}}</div>
                <ul>
                {% for method in internal_class.methods %}
                    <li>{{method}}</li>
                {% endfor %}
                </ul>
            {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>
